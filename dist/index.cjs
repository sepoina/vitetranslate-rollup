"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const d=require("path"),f=require("fs");function _(t){var r,e,n;if(((e=(r=t==null?void 0:t.container)==null?void 0:r.children)==null?void 0:e.length)===1){const a=t.container.children[0];return a.type==="JSXText"?a.value:a.type==="JSXExpressionContainer"&&((n=a==null?void 0:a.expression)!=null&&n.value)?a.expression.value:!1}return!1}function S(t,r){var n,a,o,l;const e=r.node.attributes.find(s=>{var c;return((c=s==null?void 0:s.name)==null?void 0:c.name)===t});return e?((n=e==null?void 0:e.value)==null?void 0:n.type)==="StringLiteral"?e.value.value:((a=e==null?void 0:e.value)==null?void 0:a.type)==="JSXExpressionContainer"&&((l=(o=e==null?void 0:e.value)==null?void 0:o.expression)==null?void 0:l.type)==="StringLiteral"?e.value.expression.value:!1:!1}function m(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var b={exports:{}};(function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),e.BASE=2166136261;function e(n,a=e.BASE){const o=n.length;for(let l=0;l<o;l++)a^=n.charCodeAt(l),a+=(a<<1)+(a<<4)+(a<<7)+(a<<8)+(a<<24);return a>>>0}r.default=e,t.exports=e})(b,b.exports);var p=b.exports;const x=m(p);function g(t,r){var a,o;if(!((a=t==null?void 0:t.node)!=null&&a.value)||!/_%_(.*?)_%_/.test(t.node.value))return;const e=(o=/_%_(.*?)_%_/.exec(t.node.value))==null?void 0:o[1],n=v(e,r);t.node.value=T(t.node.value,n,e),t.node.extra.rawValue&&(t.node.extra.rawValue=T(t.node.extra.rawValue,n,e)),t.node.extra.raw&&(t.node.extra.raw=T(t.node.extra.raw,n,e))}function T(t,r,e){const n=`_<_${r}_/_${e}_>_`;return t.replace(/_%_(.*?)_%_/,n)}function v(t,r){const e=d.parse(r.filename).name,n=x(t).toString(36),a=`${e}_${n}`;return globalThis.TranslateService.baseLng[a]=t,a}const w=t=>{const{types:r}=t;return{visitor:{StringLiteral:g,JSXText:g,TemplateElement:g,JSXOpeningElement(e,n){if(e.node.name.name!=="Translate"||e.node.attributes.find(i=>{var u;return((u=i==null?void 0:i.name)==null?void 0:u.name)==="data-translate"})||e.node.attributes.find(i=>(i==null?void 0:i.name.name)==="c"))return;const l=e.node.attributes.find(i=>{var u;return((u=i==null?void 0:i.name)==null?void 0:u.name)==="t"})?S("t",e):_(e);if(l===!1)throw"Error, Translate require constant string";const s=v(l,n),c=r.jSXAttribute(r.jSXIdentifier("data-translate"),r.stringLiteral(s));e.node.attributes.push(c)}}}};function h(){return process.env.NODE_ENV==="production"}function y(t){return{name:"onRollupTranslate",buildStart:{sequential:!0,order:"pre",handler:()=>{globalThis.TranslateService=t,globalThis.TranslateService.baseLng={__lngVersion__:L()},h()||console.log(`
::: Vite-Translate: Start translate service in development mode, not update translation table file, make a new build for this
`)}},buildEnd:{sequential:!0,order:"post",handler:()=>{h()&&P()}}}}function P(){const t=d.join(globalThis.TranslateService.baseDir,...globalThis.TranslateService.publicTableDir,globalThis.TranslateService.PredefinedLanguage),r=d.join(globalThis.TranslateService.baseDir,...globalThis.TranslateService.distTableDir,globalThis.TranslateService.PredefinedLanguage),e=d.join(...globalThis.TranslateService.publicTableDir,globalThis.TranslateService.PredefinedLanguage),n=d.join(...globalThis.TranslateService.distTableDir,globalThis.TranslateService.PredefinedLanguage);console.log("| Vite-Translate ---------------------------------------------"),console.log("| Load base translation table from ",e);try{f.readFile(t,"utf8",(a,o)=>{let l={newest:!0,changed:!0},s=null;if(a)console.log(`| The file ${e} not exist, i make new one.`),s=globalThis.TranslateService.baseLng;else{s=JSON.parse(o);const c=globalThis.TranslateService.baseLng;l=E(s,c)}l.changed?(console.log(l.newest?"| Create new file.":`| Update: (${l.added} added, ${l.deleted} removed)`),f.writeFile(t,JSON.stringify(s,null,2),"utf8",c=>{c?console.error(`| Error writing over ${e}`,c):(console.log(`| Correct writing operation ${e}`),f.copyFile(t,r,i=>{i||console.log(`| Correct copy to ${n}`),console.log("| ------------------------------------------------------------")}))})):(console.log("| Nothing change."),console.log("| ------------------------------------------------------------"))})}catch(a){console.error(`| Error in ${t}, erase this file and restart build.`,a);return}}function E(t,r){const e={changed:!1,deleted:0,added:0};for(const n in t)n in r||(delete t[n],e.changed=!0,e.deleted+=1);for(const n in r)n in t||(t[n]=r[n],e.changed=!0,e.added+=1);return e.changed&&(t.__lngVersion__=r.__lngVersion__),e}function L(){return Date.now()}exports.babelTranslate=w;exports.rollupTranslate=y;
//# sourceMappingURL=index.cjs.map
